[TOC]

# 无监督学习-课程导学

利用无标签的数据学习数据的分布或数据与数据之间关系

无监督学习最常应用的场景是聚类和降维



## 聚类问题

聚类，就是根据数据的相似性将数据分为多类的过程

评估两个不同样本之间的相似性，通常使用的方法就是计算两个样本之间的距离，使用不同方法计算样本间的距离会关系到聚类结果的好坏



### 常用的距离计算方法

#### 欧式距离

最常用的方法，源于欧式空间中两点的距离

$d =  \sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$

通用公式：

$d = \sqrt{\sum_{k=1}^n(x_{1k}-x_{2k})^2}$



#### 曼哈顿距离

也称为“城市街区距离”，类似于在城市之中驾车行驶，从一个十字路口到另外一个十字路口的距离

二维中的计算公式：

$d = \left|x_1-x_2\right|+\left|y_1-y_2\right|$

通用公式：

$d = \sum_{k=1}^n\left|x_1-x_2\right|^2$



#### 马氏距离

表示数据的协方差距离，是一种尺度无关的度量方式，也就是说马氏距离会先将样本点的各个属性标准化，再计算样本间的距离

计算公式：

$d(x_i,x_j)=\sqrt{(x_i-x_j)^Ts^{-1}(x_i-x_j)}$ 其中`s`是协方差矩阵



#### 夹角余弦

余弦相似度用向量空间中两个向量夹角的余弦值作为衡量两个样本差异的大小，余弦值越接近1，说明两个向量夹角越接近0度，表明两个向量越相似

二维空间中的计算公式：

$cos(\theta)=\frac{x_1x_2+y_1y_2}{\sqrt{x_1^2+y_1^2}\cdot\sqrt{x_2^2+y_2^2}}$

通用计算公式：

$cos(\theta)=\frac{\sum_{k=1}^nx_{1k}x_{2k}}{\sqrt{\sum_{k=1}^nx_{1k}^2}\sqrt{\sum_{k=1}^nx_{2k}^2}}$



## sklearn vs 聚类

sklearn库提供的常用聚类算法函数包含在`sklearn.cluster`这个模块中，如：`K-Means`，近邻传播算法，DBSCAN等

注意：以同样的数据集应用于不同算法，可能会得到不同的结果，算法所耗费的数据也不尽相同，这是由算法的特性决定的



### 各种算法的输入

`sklearn.cluster`模块提供的各聚类算法函数可以使用不同的数据形式作为输入：

+ 标准数据输入格式：【样本个数，特征个数】定义的矩阵形式
+ 相似性矩阵输入格式：即由【样本数目】定义的矩阵形式，矩阵中的每一个元素为两个样本的相似度，如DBSCAN，`AffinityPropagation`（近邻传播算法）接受这种输入。如果以余弦相似度为例，则对角线元素全为1.矩阵中每个元素的取值范围为【0，1】



### 具有代表性的算法

| 算法名称          | 参数                     | 可扩展性                       | 相似性度量       |
| ----------------- | ------------------------ | ------------------------------ | ---------------- |
| K-means           | 聚类个数                 | 大规模数据                     | 点间距离         |
| DBSCAN            | 邻域大小                 | 大规模数据                     | 点间距离         |
| Gaussian Mixtures | 聚类个数及其它超参       | 复杂度高，不适合处理大规模数据 | 马氏距离         |
| Birch             | 分支因子，阈值等其它超参 | 大规模数据                     | 两点间的欧式距离 |



## 降维问题

降维，就是在保证数据所具有的代表性特性或者分布的情况下，将高维数据转化为低维数据的过程

+ 用于数据的可视化
+ 精简数据



### 分类 vs 降维

聚类和分类都是无监督学习的典型任务，任务之间存在关联，比如某些高维数据的分类可以通过降维处理更好地获得，另外学术界研究表明代表性的分类算法如k-means于降维算法如NMF之间存在等价性



### 降维算法

+ 到目前位置sklearn库提供了7种降维算法

+ 降维过程也可以理解为对数据集的组成成分进行分解的过程，因此sklearn对降维模块命名为decomposition，在对降维算法调用时需要使用`sklearn.decomposition`模块



### 常用降维算法

| 算法名称  | 参数               | 可扩展性     | 适用任务           |
| --------- | ------------------ | ------------ | ------------------ |
| `PCA`     | 所降维度及其它超参 | 大规模数据   | 信号处理等         |
| `FastICA` | 所降维度及其它超参 | 超大规模数据 | 图形图像特征提取   |
| `NMF`     | 所降维度及其它超参 | 大规模数据   | 图形图像特征提取   |
| `LDA`     | 所降维度及其它超参 | 大规模数据   | 文本数据，主题挖掘 |



### 解决具体问题

+ 31省市居民家庭消费调查
+ 学生月上网时间分布调查
+ 人脸图像特征抽取
+ 图像分割

****

